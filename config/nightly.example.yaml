# EvolveRFC 夜间守护进程配置示例
# 完整配置参考，复制为 config/nightly.yaml 使用

# ============================================
# 夜间守护进程核心配置
# ============================================
nightly:
  # 触发时间（UTC 0点，即北京时间 8点）
  trigger_hour: 0

  # ============================================
  # 代码审计模式配置
  # ============================================
  code_analysis:
    scope: "diff"            # "full" 全量扫描 或 "diff" 仅 diff
    focus_dirs: ["src"]      # 聚焦分析的目录
    max_files_analyze: 10    # 单次最多分析文件数

  # ============================================
  # RFC 预讨论模式配置
  # ============================================
  rfc_pre_discussion:
    enabled: true            # 是否启用预讨论模式
    max_rfcs_per_night: 5    # 每晚最多预讨论的 RFC 数量

  # ============================================
  # 创新提案模式配置
  # ============================================
  creative_proposal:
    enabled: true            # 是否启用创新提案模式
    max_rounds: 5            # 最大辩论轮次
    daily_output_limit: 1    # 每日输出数量限制

    # 通过条件配置（结构化）
    # 不再使用字符串表达式，而是明确的数值条件
    yes_votes_needed: 2      # 需要的最少赞成票
    no_votes_limit: 2        # 反对票上限（超过此值直接淘汰）
    require_yes_over_no: true  # 是否要求赞成票 > 反对票

    # 代码路径配置（智能体阅读参考）
    code_review_paths: ["src"]

  # ============================================
  # 模式轮询权重配置
  # ============================================
  # 夜间守护进程根据权重随机选择运行模式
  # 权重总和不需要等于 1，程序会自动归一化
  mode_weights:
    audit: 0.4          # 40% 概率：深度代码审计
    pre_discussion: 0.3 # 30% 概率：现有 RFC 预讨论
    creative: 0.3       # 30% 概率：创新提案生成

  # ============================================
  # 输出控制配置
  # ============================================
  output:
    notify_on_empty: false   # 无输出时是否发送通知
    max_output_per_night: 1  # 每晚最大输出次数

# ============================================
# LLM 配置（可选）
# 覆盖全局 LLM 设置，仅对夜间守护进程生效
# ============================================
llm:
  provider: openai          # openai | anthropic
  model: gpt-4o             # 模型名称
  temperature: 0.7          # 温度
  # base_url: ...           # 可选：代理地址
  # timeout: 60.0           # Anthropic 超时时间（秒）
  # stop: ["\n\n"]          # Anthropic 停止词列表
