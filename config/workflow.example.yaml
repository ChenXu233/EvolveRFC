# EvolveRFC 工作流配置示例
# 完整配置参考，复制为 config/workflow.yaml 使用

# ============================================
# 路由规则配置
# ============================================
routing:
  max_rounds: 10              # 最大讨论轮次
  round_timeout_minutes: 30   # 人类决策超时时间（分钟）

  # 路由规则（按优先级排序，数字越小优先级越高）
  rules:
    - name: emergency_stop
      condition: "human_decision.action == 终止"
      priority: 1

    - name: human_intervention
      condition: "awaiting_human_input == true"
      priority: 2

    - name: max_rounds_reached
      condition: "current_round >= max_rounds"
      priority: 3

    - name: consensus_reached
      condition: "open_issues is empty"
      priority: 4

# ============================================
# 投票阈值配置
# ============================================
thresholds:
  deadlock_opposition_ratio: 0.3   # 反对票比例超过此值视为僵局，需人类介入
  consensus_quorum: 0.8            # 赞成票比例达到此值即达成共识

# ============================================
# 角色配置（动态配置，支持添加/删除/自定义）
# ============================================
roles:
  # === 首席架构师 ===
  # 职责：评估架构设计、识别技术债务、检查 SOLID 原则
  architect:
    enabled: true
    must_speak: true      # 必须发言
    can_vote: true        # 有投票权
    prompt_file: prompts/architect.txt
    # 可选：覆盖全局 LLM 设置
    # llm:
    #   provider: openai
    #   model: gpt-4o
    #   temperature: 0.7
    #   base_url: https://api.openai.com/v1  # 代理地址

  # === 安全偏执狂 ===
  # 职责：识别安全漏洞、检查数据保护、评估认证授权
  security:
    enabled: true
    must_speak: true
    can_vote: true
    prompt_file: prompts/security.txt
    # 可选：使用 Claude 进行更深入的安全分析
    # llm:
    #   provider: anthropic
    #   model: claude-sonnet-4-20250514
    #   temperature: 0.3  # 安全分析需要更低的温度

  # === 成本控制型运维 ===
  # 职责：评估基础设施成本、检查运维复杂度、监控可观测性
  cost_control:
    enabled: true
    must_speak: true
    can_vote: true
    prompt_file: prompts/cost_control.txt
    # 可选：使用更便宜的模型
    # llm:
    #   provider: openai
    #   model: gpt-4o-mini
    #   temperature: 0.5

  # === 激进创新派 ===
  # 职责：评估新技术可能性、挑战保守设计、提出创新建议
  innovator:
    enabled: true
    must_speak: false     # 可选发言（但仍有投票权）
    can_vote: true        # 显式声明有投票权
    prompt_file: prompts/innovator.txt
    # 可选：使用更具创意的模型配置
    # llm:
    #   provider: openai
    #   model: gpt-4o
    #   temperature: 1.0  # 更高的温度产生更多创意

  # === 书记官 ===
  # 职责：总结讨论、提炼共识、起草报告（不参与投票）
  clerk:
    enabled: true
    must_speak: false
    can_vote: false       # 明确无投票权
    prompt_file: prompts/clerk.txt
    # 可选：使用较短的上下文窗口
    # llm:
    #   provider: openai
    #   model: gpt-4o-mini

  # === 自定义角色示例：性能优化专家 ===
  # 取消注释以启用此角色
  # performance:
  #   enabled: true
  #   must_speak: true
  #   can_vote: true
  #   prompt_file: prompts/performance.txt
  #   # 性能分析使用 Claude
  #   llm:
  #     provider: anthropic
  #     model: claude-sonnet-4-20250514

# ============================================
# 全局 LLM 配置
# ============================================
# 所有角色的默认配置，未在角色中单独配置时使用
llm:
  provider: openai            # openai | anthropic
  model: gpt-4o               # 模型名称
  temperature: 0.7            # 0.0-2.0，值越高越有创意
  base_url: https://api.openai.com/v1  # 可选：代理地址或第三方兼容 API
  # timeout: 60.0             # Anthropic 超时时间（秒）
  # stop: ["\n\n"]            # Anthropic 停止词列表

# ============================================
# 添加自定义角色的步骤
# ============================================
# 1. 在 roles 下添加角色配置
# 2. 创建 prompts/{角色名}.txt 提示词文件
# 3. 重启服务即可生效
#
# 提示词文件格式：
# - 系统角色定义
# - 评审输出格式（论点、论据、立场、置信度）
